
### 核心背景
置信区间和共形预测都是估计未知总体参数近似值范围的统计方法，置信区间用于量化总体参数的置信水平，共形预测则用于创建以一定概率覆盖真实结果的预测区间，本章重点解释二者差异及共形预测的实现方法。

### 一、置信区间与预测区间的区别
1. **置信区间**：侧重刻画**总体特征的参数**（如人口平均身高的95%置信区间为5英尺6英寸到5英尺8英寸），在机器学习中用于估计模型准确度这类总体参数。
2. **预测区间**：为**单个预测目标值**提供值域（如某个体重185磅的人，身高预测区间为5英尺8英寸至6英尺），在机器学习中估计单个输入样本的输出值范围。

### 二、预测区间与共形预测
1. **共性**：均用于估测单个模型预测的不确定性。
2. **差异**：
   - 预测区间：假设特定数据分布，与特定模型类型相关。
   - 共形预测：不受分布限制，可应用于任何机器学习算法，是预测区间更灵活、普遍的形式，但需更多计算资源。

### 三、预测区域、预测区间与预测集合（共形预测术语）
术语使用取决于任务性质：
1. **预测区间**：回归任务（连续输出）中，指一定置信水平下真实预测的数值范围（如房价预测20万-25万美元）。
2. **预测集合**：分类任务（离散输出）中，包含给定实例所有可能的分类标签（如图像预测为猫、狗、鸟）。
3. **预测区域**：通用术语，可指代预测区间或预测集合，描述模型认为合理的输出集合。

### 四、计算共形预测
1. **数据划分**：将数据分为训练集（60%）、校准集（20%）、测试集（20%），训练集训练模型，校准集确定共形预测参数，测试集评测性能。
2. **核心步骤**：
   - 定义**非一致性度量**：为校准集每个实例的“异常程度”分配分数（如1减去分类标签的预测概率，分数越高越异常）。
   - 计算分位数阈值：用校准集的非一致性得分确定阈值（如95%置信水平下，取95%实例的非一致性得分低于的阈值）。
   - 构建预测区域：对新数据的每个可能输出，若其非一致性得分低于阈值，则纳入预测集合。

### 五、共形预测示例（评分法）
以区分麻雀、知更鸟、鹰的分类任务为例：
1. 从校准集获取各真实类别标签的预测概率，计算非一致性得分（1 - 概率）。
2. 选择95%置信水平的阈值（示例中为0.8）。
3. 对新实例计算非一致性得分，将得分低于阈值的类别纳入预测集合（如麻雀0.26、知更鸟0.45低于0.8，预测集合为[麻雀, 知更鸟]）。

### 六、共形预测的优点
1. 理论保障与通用性：对数据/模型分布无假设，可结合任何机器学习算法。
2. 有限样本保障：确保任何样本量都能达到预期覆盖率（如95%置信水平下，100个测试点中95个会包含真实标签），而置信区间依赖渐近性质（样本量越大保障越稳）。
3. 局限性：并非总能提供最精确的预测区间，若分类器基本假设成立，其自身概率估计可能更精准。

### 七、应用建议
1. 置信区间：反映模型属性的不确定性（如预测准确度），用于比较、评测和选择模型。
2. 预测区间/共形预测：反映单个预测的不确定性，助力模型实际应用（如识别不确定情况，补充数据或人工监督）。

### 八、练习问题
1. 预测集合的大小在不同实例间有差异，其大小能反映什么信息？
2. 回归问题中能否使用共形预测和置信区间？

